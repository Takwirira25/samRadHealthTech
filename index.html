<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>samRad Health Technologies</title>
    <link href="https://fonts.googleapis.com/css2?family=Segoe+UI:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        /* Base Styles */
        body {
            font-family: 'Segoe UI', sans-serif;
            margin: 0;
            background: linear-gradient(to right, #f0f4f8, #dbe4ee); /* Softer, muted gradient */
            color: #333;
            line-height: 1.6;
            scroll-behavior: smooth;
        }

        /* Header */
        header {
            background: linear-gradient(to right, #0a2342, #1b3a61); /* Deeper, richer blue gradient */
            color: #fff;
            padding: 0.8rem 1.5rem; /* Slightly more padding for a softer feel */
            box-shadow: 0 4px 15px rgba(0,0,0,0.25);
            position: sticky;
            top: 0;
            z-index: 1000;
            display: flex;
            flex-direction: column;
            align-items: center;
            text-align: center;
        }

        header h1 {
            margin: 0;
            font-size: 2.1rem; /* Slightly larger, more prominent */
            color: #e0efff; /* Lighter, more vibrant blue */
            text-shadow: 2px 2px 5px rgba(0,0,0,0.4),
                         4px 4px 10px rgba(0,0,0,0.25);
            letter-spacing: 0.06rem;
            line-height: 1.2;
        }
        
        /* Navigation (Desktop) */
        nav.nav-links {
            margin-top: 0.8rem; /* More margin from title */
            display: flex;
            justify-content: center;
            gap: 1.8rem; /* Increased gap */
            flex-wrap: wrap;
        }

        nav a {
            color: #cee7f0; /* Softer light blue */
            text-decoration: none;
            font-weight: 600;
            position: relative;
            white-space: nowrap;
            padding-bottom: 6px; /* Slightly more padding */
            transition: color 0.3s ease;
            font-size: 1.0rem; /* Slightly larger */
        }

        nav a::after {
            content: '';
            display: block;
            width: 0;
            height: 3px; /* Thicker underline */
            background: #6bb9ed; /* More distinct blue */
            transition: width 0.3s ease-in-out;
            position: absolute;
            bottom: 0;
            left: 0;
        }

        nav a:hover,
        nav a.active {
            color: #ffffff; /* Pure white on hover */
        }

        nav a:hover::after,
        nav a.active::after {
            width: 100%;
        }

        /* Main Container */
        .container {
            padding: 3.5rem 7vw; /* Increased padding */
            max-width: 1400px; /* Wider container */
            margin: 0 auto;
            animation: fadeIn 1.5s ease-out; /* Slower fade-in */
        }

        /* Headings */
        h1, h2 {
            color: #0a2342; /* Consistent deep blue */
            margin-bottom: 1.5rem; /* More space below headings */
        }

        h2 {
            color: #0a2342;
            font-size: 2.2rem; /* Larger font size */
            border-bottom: 2px solid #c0d4e7; /* Softer border color */
            padding-bottom: 0.8rem;
            position: relative;
            text-shadow: 1px 1px 3px rgba(0,0,0,0.2),
                         2px 2px 5px rgba(0,0,0,0.15);
        }

        h2::before {
            content: '';
            position: absolute;
            bottom: -2px;
            left: 0;
            width: 60px; /* Longer underline accent */
            height: 4px; /* Thicker underline accent */
            background: #007bff;
        }

        /* Sections */
        section {
            margin-bottom: 4rem; /* More space between sections */
            padding: 2.5rem; /* More internal padding */
            border-radius: 15px; /* More rounded corners */
            background-color: #ffffff;
            box-shadow: 0 8px 30px rgba(0,0,0,0.1); /* Deeper, softer shadow */
            transition: all 0.5s ease;
        }

        section.active-section {
            background: #e6f0fa; /* Slightly more saturated active background */
            box-shadow: 0 12px 40px rgba(0,0,0,0.2); /* Even deeper shadow */
        }

        /* Services Grid */
        .services-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(320px, 1fr)); /* Slightly larger min-width */
            gap: 2.5rem; /* Increased gap */
            margin-top: 2.5rem;
        }

        .service-card {
            background: #ffffff;
            padding: 2.2rem; /* More internal padding */
            border-radius: 15px;
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.1); /* Softer shadow */
            border-left: 8px solid #007bff; /* Thicker border */
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
        }

        .service-card:hover {
            transform: translateY(-10px); /* More pronounced lift */
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.25);
        }

        .service-card h3 {
            margin-top: 0;
            color: #0a2342;
            font-size: 1.6rem; /* Larger font */
            margin-bottom: 1rem;
        }

        .service-card p {
            color: #5d6d7e; /* Slightly darker body text */
        }

        /* Buttons */
        button {
            background-color: #007bff;
            color: #fff;
            border: none;
            padding: 1.1rem 2.2rem; /* Larger padding */
            border-radius: 10px; /* More rounded */
            cursor: pointer;
            font-size: 1.1rem; /* Slightly larger font */
            font-weight: 600;
            transition: background-color 0.3s ease, transform 0.2s ease, box-shadow 0.3s ease;
            display: inline-block;
            margin-right: 18px; /* More spacing */
            box-shadow: 0 4px 12px rgba(0,0,0,0.15); /* Stronger initial shadow */
            text-transform: uppercase; /* Modern touch */
            letter-spacing: 0.03em;
        }

        button:hover {
            background-color: #0056b3;
            transform: translateY(-4px); /* More pronounced lift */
            box-shadow: 0 8px 20px rgba(0,0,0,0.25);
        }

        button:active {
            transform: translateY(-1px); /* Slight sink */
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }

        button:disabled {
            background-color: #aebfd0; /* Softer disabled color */
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }

        /* Quiz Specific Styles */
        #quiz-form label {
            display: block;
            margin-bottom: 1rem; /* More spacing */
            cursor: pointer;
            font-size: 1.1rem; /* Larger font */
            color: #4a657e; /* Darker, more readable */
            transition: color 0.2s ease;
            padding: 8px 0; /* Add padding for better click target */
        }

        #quiz-form label:hover {
            color: #007bff;
        }

        #quiz-form label input[type="radio"] {
            margin-right: 1rem; /* More spacing */
            transform: scale(1.3); /* Slightly larger radio buttons */
            accent-color: #007bff; /* Custom color for radio buttons */
        }

        #quiz-result p {
            margin-bottom: 1rem;
            font-size: 1.15rem; /* Slightly larger */
        }

        /* Radiation Animation Styles */
        #animation-container-horizontal {
            position: relative;
            width: 100%;
            max-width: 500px; /* Slightly larger animation area */
            height: 350px; /* Taller */
            margin: 3rem auto;
            background: linear-gradient(to bottom right, #f8fcfd, #e0effa); /* Light, airy background */
            border-radius: 20px; /* More rounded */
            overflow: hidden;
            border: 2px solid #c7dbe8;
            box-shadow: inset 0 0 15px rgba(0,0,0,0.08), 0 10px 30px rgba(0,0,0,0.15); /* More prominent inner and outer shadow */
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .gantry-circle {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%) rotate(0deg);
            width: 280px; /* Larger gantry */
            height: 280px;
            border-radius: 50%;
            z-index: 4;
            transition: transform 0.1s linear;
            background: transparent;
            border: none;
            /* Using multiple background layers and masks to create segmented ring */
            background-image: 
                radial-gradient(circle at center, transparent 80%, #4a4a4a 80%, #4a4a4a 85%, transparent 85%), /* Darker core */
                radial-gradient(circle at center, transparent 70%, #666 70%, #666 75%, transparent 75%), /* Lighter segment */
                radial-gradient(circle at center, transparent 60%, #555 60%, #555 65%, transparent 65%); /* Even lighter segment */
            background-size: 100% 100%;
            background-repeat: no-repeat;
            box-shadow: 0 0 20px rgba(0,0,0,0.4); /* Stronger outer shadow */
            mask-image: radial-gradient(circle at center, transparent 80%, black 80%); /* Define ring shape */
            -webkit-mask-image: radial-gradient(circle at center, transparent 80%, black 80%); /* For webkit browsers */
        }
        
        .gantry-circle.no-transition {
            transition: none !important;
        }

        .gantry-head {
            width: 45px; /* Larger head */
            height: 45px;
            background: linear-gradient(45deg, #2c3e50, #4c667f); /* Darker, metallic gradient */
            border-radius: 50%;
            position: absolute;
            top: -32px; /* Adjusted to new gantry size */
            left: calc(50% - 22.5px);
            box-shadow: 0 0 12px rgba(0,0,0,0.6);
            display: flex;
            justify-content: center;
            align-items: center;
            border: 2px solid #888; /* Small border */
            overflow: hidden; /* To contain the aperture */
        }

        .gantry-head::before { /* Aperture effect */
            content: '';
            position: absolute;
            width: 10px;
            height: 10px;
            background-color: #00bcd4; /* Cyan color for aperture */
            border-radius: 50%;
            box-shadow: 0 0 8px 4px rgba(0,188,212,0.8); /* Glow for aperture */
            animation: aperturePulse 1.5s infinite alternate ease-in-out;
            opacity: 0; /* Hidden by default */
        }

        .gantry-head.active-aperture::before {
            opacity: 1; /* Show when active */
        }

        @keyframes aperturePulse {
            from { transform: scale(0.8); opacity: 0.7; }
            to { transform: scale(1.1); opacity: 1; }
        }

        /* Styling for the container that holds the human figure */
        .human-body-silhouette {
            position: relative;
            width: 90px; /* Slightly larger human figure */
            height: 200px; /* Taller */
            z-index: 2;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        /* Styling for the SVG element itself within the container */
        .human-body-silhouette svg {
            width: 100%;
            height: 100%;
            filter: drop-shadow(3px 3px 4px rgba(0,0,0,0.3)); /* More pronounced shadow */
        }

        /* --- THIS IS THE KEY PART FOR THE STICK FIGURE'S THICKNESS --- */
        /* Styling specifically for the <path> element that draws the stick figure */
        .human-body-silhouette svg path:first-of-type {
            fill: none;
            stroke: url(#humanGradient);
            stroke-width: 25;
        }

        .tumor {
            position: absolute;
            width: 14px; /* Slightly larger tumor */
            height: 14px;
            background: radial-gradient(circle, #e74c3c, #c0392b); /* Brighter red */
            border-radius: 50%;
            z-index: 3;
            box-shadow: 0 0 10px rgba(231,76,60,0.9); /* Stronger initial glow */
            transform: scale(1) translate(-50%, -50%); /* Corrected initial transform */
            opacity: 1;
            transition: transform 0.5s ease-out, opacity 0.5s ease-out;
            top: 55%;
            left: 50%;
            /* transform: translate(-50%, -50%) scale(1); - removed as it's set on the element */
        }

        .tumor.glowing {
            animation: tumorGlow 0.8s infinite alternate ease-in-out;
        }
        
        .tumor.impact-glow {
            animation: tumorImpactGlow 0.4s forwards;
        }

        .tumor.shrinking {
            animation: tumorShrink 0.8s forwards;
        }

        @keyframes tumorGlow {
            from { box-shadow: 0 0 10px rgba(231,76,60,0.9); }
            to { box-shadow: 0 0 20px 5px rgba(255,100,100,1); } /* Brighter, larger glow */
        }
        
        @keyframes tumorImpactGlow {
            0% { box-shadow: 0 0 25px 8px rgba(255,100,100,1); transform: translate(-50%, -50%) scale(1.2); opacity: 1; }
            100% { box-shadow: 0 0 10px rgba(231,76,60,0.9); transform: translate(-50%, -50%) scale(1); opacity: 1; }
        }

        @keyframes tumorShrink {
            from { transform: translate(-50%, -50%) scale(1); opacity: 1; }
            to { transform: translate(-50%, -50%) scale(0.1); opacity: 0; }
        }

        .beam {
            position: absolute;
            height: 8px; /* Thicker beam */
            width: 0;
            background: linear-gradient(to right, rgba(255,255,100,0.9), rgba(255,50,50,0.98)); /* Brighter, more intense color */
            top: 50%;
            left: 50%;
            transform-origin: left center;
            transform: translateY(-50%) rotate(0deg);
            box-shadow: 0 0 40px rgba(255,0,0,1), 0 0 20px rgba(255,255,0,0.8); /* Stronger, dual-color glow */
            border-radius: 4px; /* More rounded */
            z-index: 4;
            opacity: 0;
            transition: width 0.1s linear, opacity 0.1s linear;
        }

        .beam.firing {
            animation: beamPulse 0.3s infinite alternate, beamInternalPulse 0.5s infinite linear; /* Added internal pulse */
        }

        @keyframes beamPulse {
            from { box-shadow: 0 0 30px rgba(255,0,0,0.8), 0 0 15px rgba(255,255,0,0.6); }
            to { box-shadow: 0 0 50px 8px rgba(255,50,50,1), 0 0 25px 4px rgba(255,255,50,0.9); }
        }
        
        @keyframes beamInternalPulse {
            0% { background-position: 0 0; }
            100% { background-position: 100px 0; } /* Simulates internal energy flow */
        }


        .patient-table {
            position: absolute;
            bottom: 0;
            left: 0;
            width: 100%;
            height: 90px; /* Taller table */
            background-color: #555; /* Darker gray */
            border-top: 12px solid #3a3a3a; /* Thicker, darker border */
            z-index: 1;
            box-shadow: inset 0 8px 15px rgba(0,0,0,0.3), 0 -5px 15px rgba(0,0,0,0.1); /* Stronger inner shadow */
        }
        .patient-table::before {
            content: '';
            position: absolute;
            top: -15px; /* Adjusted to new table height */
            left: 15%; /* Wider top surface */
            width: 70%;
            height: 15px; /* Thicker top surface */
            background-color: #777; /* Lighter gray for top */
            border-top-left-radius: 8px;
            border-top-right-radius: 8px;
            box-shadow: 0 -3px 8px rgba(0,0,0,0.2);
        }
    </style>
</head>
<body>

    <header>
        <h1>samRad Health Technologies</h1>
        <nav class="nav-links">
            <a href="#about">About</a>
            <a href="#services">Services</a>
            <a href="#continuous-improvement">Advancements</a>
            <a href="#certifications">Certifications</a>
            <a href="#quiz">Imaging & Quiz</a>
            <a href="#radiation-animation">Radiation Simulation</a>
            <a href="#contact">Contact</a>
        </nav>
    </header>

    <div class="container">
        <section id="about">
            <h2>About Us</h2>
            <p>samRad Health Technologies is a visionary cancer research and healthtech enterprise. Our mission is to pioneer intelligent, automated systems that empower clinicians to detect and quantify tumors from radiological imaging with precision and ease. Our AI pipelines are open, transparent, and designed to speed up diagnostics and enhance medical research.</p>
            <p>Founded by Samuel B. Takwirira, a Zimbabwean PhD student in Physics at the University of New Hampshire in the United States, the initiative is rooted in a passion for oncology and a heartfelt commitment to expanding access to care. Coming from a background marked by economic hardship and limited access to advanced healthcare, Takwirira has firsthand experience of the challenges faced by most African communities.</p>
            <p>Through resilience and a relentless pursuit of education, he now seeks to transform lives&mdash;not just through innovation, but by creating pathways for others from similar circumstances. samRad Health Technologies aspires to forge partnerships with hospitals across Zimbabwe and Southern Africa, uplifting cancer care through technological excellence and shared knowledge.</p>
        </section>

        <section id="services">
            <h2>Our Services</h2>
            <div class="services-grid">
                <div class="service-card">
                    <h3>AI Tumor Detection</h3>
                    <p>Instant analysis of medical scan images (DICOM) to assess cancer risk using trained AI models.</p>
                </div>
                <div class="service-card">
                    <h3>Clinical Pipeline Tooling</h3>
                    <p>Command-line tools for clinical researchers to process imaging data and patient datasets efficiently at scale.</p>
                </div>
                <div class="service-card">
                    <h3>Data Integration & Interoperability</h3>
                    <p>Robust support for structured CSV metadata, clinical tagging, and export-ready research formats. Seamlessly integrate with existing hospital systems.</p>
                </div>
            </div>
        </section>

        <section id="continuous-improvement">
            <h2>Advancements</h2>
            <p>At samRad Health Technologies, our mission centers on **precision**&mdash;a quality vividly demonstrated in this radiation beam simulation. The gantry, the rotating arm of a radiation machine, precisely delivers a targeted beam to the tumor, minimizing exposure to healthy tissue. This animation highlights the **crucial role of accurate targeting** in modern cancer treatment and is a core example of the advancements we are working to bring to cancer care.</p>
        </section>

        <section id="certifications">
            <h2>Certifications & Research Ethics</h2>
            <ul>
                <li>Fully compliant with **HIPAA** data handling protocols to ensure patient data privacy and security.</li>
                <li>Model validation on ethically sourced, anonymized datasets to maintain integrity and prevent bias.</li>
                <li>Strict adherence to **IRB** (Institutional Review Board) and institutional ethics review processes for all research and development.</li>
            </ul>
        </section>

        <section id="quiz">
            <h2>Imaging and Quiz</h2>
            <p>Radiology is more than just images on a screen&mdash;it’s often the first glimpse into a life forever changed. For those touched by cancer, whether through personal battle, the struggle of a loved one, or even the fear of the unknown, the journey is deeply personal. In those moments of waiting and worry, tools like MRI, CT, and PET scans become lifelines&mdash;windows into hope, clarity, and action. Understanding these tools can bring comfort, courage, and a sense of control when everything else feels uncertain.</p>

            <p><strong>Test your knowledge:</strong></p>
            <button id="start-quiz-btn">Start Quiz</button>
            <form id="quiz-form" style="display:none; margin-top:1.5rem;"></form>
            <div id="quiz-result" style="margin-top:1.5rem; font-weight:bold;"></div>
        </section>

        <div id="radiation-animation">
            <h2>Radiation Beam Simulation</h2>
            
            <p>At samRad Health Technologies, our mission centers on **precision**—a quality vividly demonstrated in this radiation beam simulation. The gantry, the rotating arm of a radiation machine, precisely delivers a targeted beam to the tumor, minimizing exposure to healthy tissue. This animation highlights the crucial role of accurate targeting in modern cancer treatment and is a core example of the advancements we bring to cancer care.</p>
            
            <div id="animation-container-horizontal">
                <div class="gantry-circle">
                    <div class="gantry-head"></div>
                </div>
                <div class="human-body-silhouette" id="human-target">
                    <svg viewBox="0 0 100 200" preserveAspectRatio="xMidYMid meet">
                        <defs>
                            <linearGradient id="humanGradient" x1="0%" y1="0%" x2="100%" y2="100%">
                                <stop offset="0%" style="stop-color:#b0c4de;stop-opacity:1" /> 
                                <stop offset="50%" style="stop-color:#a0b4ce;stop-opacity:1" />
                                <stop offset="100%" style="stop-color:#90a4be;stop-opacity:1" /> 
                            </linearGradient>
                        </defs>
                        <path d="M50,20 A15,15 0 1 1 50,50 A15,15 0 1 1 50,20 Z 
                                  M50,50 L50,120 
                                  M50,70 L20,90 M50,70 L80,90 
                                  M50,120 L35,180 M50,120 L65,180"
                             fill="none" stroke="url(#humanGradient)" stroke-width="4"></path>
                    </svg>
                    <div class="tumor"></div>
                </div>
                <div class="beam"></div>
                <div class="patient-table"></div>
            </div>
            <button id="start-animation-btn">Start Simulation</button>
        </div>
        <section id="contact">
            <h2>Contact Us</h2>
            <p>Email: <a href="mailto:takwirira@proton.me">takwirira@proton.me</a></p>
            <p>GitHub: <a href="https://takwirira25.github.io/samRad-Health-Technologies/" target="_blank" rel="noopener noreferrer">https://takwirira25.github.io/samRad-Health-Technologies/</a></p>
        </section>
    </div>

    <footer>
        <p>&copy; 2025 samRad Health Technologies. All rights reserved.</p>
    </footer>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const headerTitle = document.querySelector('header h1');
            const navLinks = document.querySelector('nav.nav-links');
            const header = document.querySelector('header');

            if (!headerTitle || !navLinks || !header) {
                console.warn('Required header elements for mobile menu not found.');
            }

            navLinks.querySelectorAll('a').forEach(link => {
                link.addEventListener('click', () => {
                    navLinks.querySelectorAll('a').forEach(nav => nav.classList.remove('active'));
                    link.classList.add('active');
                });
            });

            // Highlight active section on scroll
            const sections = document.querySelectorAll('section, #radiation-animation');
            const highlightActiveSection = () => {
                let currentActive = null;
                sections.forEach(section => {
                    const sectionTop = section.offsetTop - header.offsetHeight - 50; // Offset for sticky header
                    const sectionBottom = sectionTop + section.offsetHeight;
                    if (window.scrollY >= sectionTop && window.scrollY < sectionBottom) {
                        currentActive = section.id;
                    }
                    section.classList.remove('active-section');
                });

                if (currentActive) {
                    document.getElementById(currentActive).classList.add('active-section');
                    navLinks.querySelectorAll('a').forEach(link => {
                        link.classList.remove('active');
                        if (link.getAttribute('href') === `#${currentActive}`) {
                            link.classList.add('active');
                        }
                    });
                }
            };

            window.addEventListener('scroll', highlightActiveSection);
            highlightActiveSection(); // Initial call on load

            // --- Quiz Data and Logic ---
            const quizData = [
                { question: "What does MRI primarily use to generate images?", options: ["X-rays", "Magnetic fields & radio waves", "Sound waves", "Gamma rays"], answer: 1 },
                { question: "What tracer is commonly used in PET scans?", options: ["Iodine-131", "Technetium-99m", "Fluorodeoxyglucose (FDG)", "Gadolinium"], answer: 2 },
                { question: "CT scans are best for visualizing:", options: ["Soft tissues", "Bone fractures", "Ligaments", "Muscle tears"], answer: 1 },
                { question: "Radiation therapy aims to:", options: ["Cure viral infections", "Kill cancer cells using ionizing radiation", "Deliver chemotherapy", "Visualize tumors"], answer: 1 },
                { question: "Which imaging technique does NOT use ionizing radiation?", options: ["CT", "PET", "MRI", "X-ray"], answer: 2 },
                { question: "PET-CT combines functional imaging with:", options: ["MRI detail", "CT detail", "Ultrasound mapping", "Bone scan"], answer: 1 },
                { question: "Which of the following is a late side effect of radiation therapy?", options: ["Hair loss", "Skin redness", "Fibrosis", "Nausea"], answer: 2 },
                { question: "MRI contrast agents often contain:", options: ["Lead", "Barium", "Gadolinium", "Iodine"], answer: 2 },
                { question: "Which scan is most sensitive for brain soft tissue detail?", options: ["X-ray", "CT", "PET", "MRI"], answer: 3 },
                { question: "Which of the following improves MRI resolution?", options: ["Higher magnetic field strength", "More X-ray dose", "Lower radiofrequency", "Using ultrasound gel"], answer: 0 }
            ];

            const startQuizBtn = document.getElementById("start-quiz-btn");
            const quizForm = document.getElementById("quiz-form");
            const quizResult = document.getElementById("quiz-result");

            function getFeedback(score, total) {
                const percent = (score / total) * 100;
                if (percent === 100) return "Outstanding! You're a radiology genius!";
                if (percent >= 80) return "Great job! You really know your imaging.";
                if (percent >= 50) return "Nice effort! A bit more study and you'll master this.";
                return "Keep learning — knowledge saves lives!";
            }

            function getFeedbackColor(percent) {
                if (percent >= 80) return "green";
                else if (percent >= 50) return "orange";
                else return "red";
            }

            function saveScore(score, total) {
                const entry = { score, total, timestamp: new Date().toISOString() };
                const scores = JSON.parse(localStorage.getItem("quizScores") || "[]");
                scores.push(entry);
                localStorage.setItem("quizScores", JSON.stringify(scores));
            }

            function renderQuestion(index, answers, next) {
                quizForm.innerHTML = "";
                const q = quizData[index];

                const qElem = document.createElement("p");
                qElem.textContent = `${index + 1}. ${q.question}`;
                quizForm.appendChild(qElem);

                q.options.forEach((opt, i) => {
                    const label = document.createElement("label");
                    const input = document.createElement("input");
                    input.type = "radio";
                    input.name = `q${index}`;
                    input.value = i;
                    input.id = `q${index}-option${i}`;

                    label.appendChild(input);
                    label.append(` ${opt}`);
                    quizForm.appendChild(label);

                    input.addEventListener("change", () => {
                        answers[index] = parseInt(input.value);
                        setTimeout(next, 300);
                    });
                });
            }

            function runQuiz() {
                let currentIndex = 0;
                const answers = {};
                quizForm.style.display = "block";
                quizResult.innerHTML = "";
                startQuizBtn.style.display = "none";

                function nextQuestion() {
                    currentIndex++;
                    if (currentIndex < quizData.length) {
                        renderQuestion(currentIndex, answers, nextQuestion);
                    } else {
                        finishQuiz(answers);
                    }
                }
                renderQuestion(currentIndex, answers, nextQuestion);
            }

            function finishQuiz(answers) {
                let score = 0;
                quizData.forEach((q, idx) => {
                    if (answers[idx] === q.answer) score++;
                });

                const total = quizData.length;
                const percent = (score / total) * 100;
                const feedback = getFeedback(score, total);
                const color = getFeedbackColor(percent);
                saveScore(score, total);

                quizForm.style.display = "none";
                startQuizBtn.style.display = "inline-block";
                startQuizBtn.textContent = "Retake Quiz";

                quizResult.innerHTML = `
                    <p>You scored ${score} out of ${total}.</p>
                    <p style="color:${color};">${feedback}</p>
                    <button id="exit-quiz-btn">Exit Quiz</button>
                    <button id="show-stats-btn">Show Highest Score</button>
                    <button id="reset-stats-btn">Reset Stats</button>
                `;

                document.getElementById("exit-quiz-btn").addEventListener("click", () => {
                    quizResult.innerHTML = "";
                    startQuizBtn.textContent = "Start Quiz";
                    const showStatsButton = document.getElementById("show-stats-btn");
                    if (showStatsButton) {
                        showStatsButton.disabled = false;
                    }
                });

                document.getElementById("show-stats-btn").addEventListener("click", () => {
                    const scores = JSON.parse(localStorage.getItem("quizScores") || "[]");
                    const statsMessage = document.createElement("p");
                    const existingStats = quizResult.querySelector('.stats-message');
                    if (existingStats) {
                        existingStats.remove();
                    }

                    if (scores.length === 0) {
                        statsMessage.textContent = "No scores recorded yet.";
                        statsMessage.style.color = "gray";
                    } else {
                        const maxScore = Math.max(...scores.map(s => s.score));
                        const percentMax = (maxScore / quizData.length) * 100;
                        statsMessage.textContent = `Your Highest Score so far is: ${maxScore} out of ${quizData.length}.`;
                        statsMessage.style.color = getFeedbackColor(percentMax);
                    }
                    statsMessage.classList.add('stats-message');
                    quizResult.appendChild(statsMessage);
                    document.getElementById("show-stats-btn").disabled = true;
                });

                document.getElementById("reset-stats-btn").addEventListener("click", () => {
                    localStorage.removeItem("quizScores");
                    Array.from(quizResult.children).forEach(el => {
                        const text = el.textContent.trim();
                        if (
                            text.startsWith("Your Highest Score so far") ||
                            text.startsWith("No scores recorded yet.") ||
                            el.classList.contains('stats-message') ||
                            text.startsWith("Stats reset successfully.")
                        ) {
                            el.remove();
                        }
                    });

                    const confirmMsg = document.createElement("p");
                    confirmMsg.textContent = "Stats reset successfully.";
                    confirmMsg.style.color = "green";
                    quizResult.appendChild(confirmMsg);
                    setTimeout(() => {
                        confirmMsg.remove();
                        const showStatsButton = document.getElementById("show-stats-btn");
                        if (showStatsButton) {
                            showStatsButton.disabled = false;
                        }
                    }, 5000);
                });
            }

            startQuizBtn.addEventListener("click", runQuiz);

            // --- Radiation Animation Script ---
            const gantry = document.querySelector('.gantry-circle');
            const gantryHead = document.querySelector('.gantry-head');
            const beam = document.querySelector('.beam');
            const tumor = document.querySelector('.tumor');
            const startAnimationBtn = document.getElementById('start-animation-btn');

            let gantryCurrentAngle = 0;

            function setGantryRotation(angle, withTransition = true) {
                if (!withTransition) {
                    gantry.classList.add('no-transition');
                }
                gantryCurrentAngle = angle % 360;
                gantry.style.transform = `translate(-50%, -50%) rotate(${gantryCurrentAngle}deg)`;
                if (!withTransition) {
                    void gantry.offsetWidth; // Trigger reflow
                    gantry.classList.remove('no-transition');
                }
            }

            function resetAnimations() {
                gantry.getAnimations().forEach(anim => anim.cancel());
                beam.getAnimations().forEach(anim => anim.cancel());
                tumor.getAnimations().forEach(anim => anim.cancel());

                setGantryRotation(0, false);
                beam.style.width = '0';
                beam.style.opacity = '0';
                beam.classList.remove('firing');
                gantryHead.classList.remove('active-aperture'); // Hide aperture glow

                tumor.style.transform = 'translate(-50%, -50%) scale(1)';
                tumor.style.opacity = '1';
                tumor.classList.remove('glowing', 'shrinking', 'impact-glow');

                startAnimationBtn.disabled = false;
                startAnimationBtn.textContent = "Start Simulation";
            }

            async function startRadiationAnimation() {
                startAnimationBtn.disabled = true;
                startAnimationBtn.textContent = "Simulating...";
                resetAnimations();

                const BEAM_FIRE_ANGLE = 270; 
                const GANTRY_ROTATION_DURATION = 2500;
                const BEAM_FIRE_DURATION = 1200; 
                const TUMOR_SHRINK_DURATION = 800;
                const APERTURE_DELAY = 100; // Delay before aperture appears

                let angleDiff = BEAM_FIRE_ANGLE - gantryCurrentAngle;
                if (angleDiff > 180) angleDiff -= 360;
                if (angleDiff < -180) angleDiff += 360;
                const targetAngleForAnimation = gantryCurrentAngle + angleDiff;

                // 1. Rotate gantry
                const gantryAnimation = gantry.animate(
                    [
                        { transform: `translate(-50%, -50%) rotate(${gantryCurrentAngle}deg)` },
                        { transform: `translate(-50%, -50%) rotate(${targetAngleForAnimation}deg)` }
                    ],
                    {
                        duration: GANTRY_ROTATION_DURATION,
                        iterations: 1,
                        fill: 'forwards',
                        easing: 'ease-in-out'
                    }
                );
                await gantryAnimation.finished;
                setGantryRotation(BEAM_FIRE_ANGLE, false); // Lock final angle

                await new Promise(resolve => setTimeout(resolve, 600)); // Pause

                // 2. Fire beam and shrink tumor
                gantryHead.classList.add('active-aperture'); // Show aperture glow
                tumor.classList.add('glowing'); // Start tumor glow before beam for anticipation

                // Calculate beam length
                const animationContainer = document.getElementById('animation-container-horizontal');
                const containerRect = animationContainer.getBoundingClientRect();
                const tumorRect = tumor.getBoundingClientRect();

                const tumorCenterX = tumorRect.left + tumorRect.width / 2 - containerRect.left;
                const tumorCenterY = tumorRect.top + tumorRect.height / 2 - containerRect.top;

                const beamStartX = containerRect.width / 2;
                const beamStartY = containerRect.height / 2;

                const beamLength = Math.sqrt(
                    Math.pow(tumorCenterX - beamStartX, 2) +
                    Math.pow(tumorCenterY - beamStartY, 2)
                );

                beam.style.transform = `translateY(-50%) rotate(${BEAM_FIRE_ANGLE}deg)`;
                beam.style.transformOrigin = 'left center';

                await new Promise(resolve => setTimeout(resolve, APERTURE_DELAY)); // Short delay for aperture

                beam.classList.add('firing');
                beam.style.opacity = '1';

                const beamAnimation = beam.animate(
                    [
                        { width: '0px' },
                        { width: `${beamLength}px` }
                    ],
                    {
                        duration: 300,
                        iterations: 1,
                        fill: 'forwards',
                        easing: 'ease-out'
                    }
                );

                await beamAnimation.finished;
                
                // Tumor impact and shrinking start simultaneously with beam at full length
                tumor.classList.remove('glowing'); // Stop continuous glow
                tumor.classList.add('impact-glow'); // Trigger impact glow
                tumor.classList.add('shrinking');

                const tumorShrinkAnimation = tumor.animate(
                    [
                        { transform: 'translate(-50%, -50%) scale(1)', opacity: 1 },
                        { transform: 'translate(-50%, -50%) scale(0.1)', opacity: 0 }
                    ],
                    {
                        duration: TUMOR_SHRINK_DURATION,
                        fill: 'forwards',
                        easing: 'ease-out'
                    }
                );

                await Promise.all([
                    tumorShrinkAnimation.finished,
                    new Promise(resolve => setTimeout(resolve, BEAM_FIRE_DURATION))
                ]);

                // 3. Retract beam
                const beamRetractAnimation = beam.animate(
                    [
                        { width: `${beamLength}px`, opacity: 1 },
                        { width: '0px', opacity: 0 }
                    ],
                    {
                        duration: 300,
                        iterations: 1,
                        fill: 'forwards',
                        easing: 'ease-in'
                    }
                );
                await beamRetractAnimation.finished;

                // Reset all states
                beam.classList.remove('firing');
                gantryHead.classList.remove('active-aperture'); // Hide aperture glow
                tumor.classList.remove('glowing', 'shrinking', 'impact-glow');
                tumor.style.transform = 'translate(-50%, -50%) scale(1)'; 
                tumor.style.opacity = '1';

                startAnimationBtn.disabled = false;
                startAnimationBtn.textContent = "Start Simulation";
            }

            startAnimationBtn.addEventListener('click', startRadiationAnimation);

            // Add smooth scrolling for navigation links
            document.querySelectorAll('nav a').forEach(anchor => {
                anchor.addEventListener('click', function (e) {
                    e.preventDefault();
                    document.querySelector(this.getAttribute('href')).scrollIntoView({
                        behavior: 'smooth'
                    });
                });
            });

        });
    </script>
</body>
</html>
